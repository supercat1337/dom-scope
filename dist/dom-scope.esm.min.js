var p="scope-name",_="ref";function d(i,e,r="default"){var t;return e.is_scope_element?t=e.is_scope_element(i,e):t=i.getAttribute(e.scope_attr_name),t===null?!1:t===""?r:t}function u(i){return Object.assign({},{scope_attr_name:p,ref_attr_name:_,document:null,is_scope_element:void 0},i)}function w(i,e,r={}){var t={},s={},n=u(r);function a(o){var f=o.getAttribute(n.ref_attr_name);if(f!=null&&f!=""&&(t[f]?console.warn(`ref #${f} is already used`):t[f]=o),o!=i){var l=d(o,n);typeof l=="string"&&(l==""&&(l="default"),s[l]?console.warn(`scope #${l} is already used`):s[l]=o)}e&&e(o)}return c(i,a,n),{refs:t,scope_refs:s}}function y(i,e){var r={},t=u(e);function s(n){let a=n.getAttribute(t.ref_attr_name);a&&(r[a]=n)}return c(i,s,t),r}function c(i,e,r){var t=u(r);function s(o){var f=o,l=f.parentElement;return l&&l!=i&&d(l,t)?2:1}let n=(t.document||i.ownerDocument).createTreeWalker(i,1,s);for(var a;a=n.nextNode();)e(a)}var h=class i{#e;#t=!0;#r;#s;options={};constructor(e){this.#e=e}get root(){return this.#e}get refs(){return this.#t&&this.update(),this.#r}get scopes(){return this.#t&&this.update(),this.#s}update(e){if(this.#e===null)throw new Error("Object is already destroyed");let{refs:r,scope_refs:t}=w(this.#e,e,this.options);this.#r=r;let s={};for(let n in t)s[n]=new i(t[n]),s[n].options=this.options;this.#s=s,this.#t=!1}querySelector(e){if(this.#e===null)throw new Error("Object is already destroyed");let r=this.#e.querySelector(e);return!r||!this.contains(r,!0)?null:r}querySelectorAll(e){if(this.#e===null)throw new Error("Object is already destroyed");var r=this.#e.querySelectorAll(e);if(r.length==0)return[];var t=[];for(let s=0;s<r.length;s++)this.contains(r[s],!0)&&t.push(r[s]);return t}contains(e,r=!1){if(this.#e===null)throw new Error("Object is already destroyed");if(r===!1&&!this.#e.contains(e))return!1;var t=this.scopes;for(let s in t){let n=t[s];if(n.#e==e)return!0;if(n.#e.contains(e))return!1}return!0}walk(e){if(this.#e===null)throw new Error("Object is already destroyed");c(this.#e,e,this.options)}destroy(){this.#e=null,this.#t=!1,this.#r={},this.#s={},this.options={}}};export{h as DomScope,y as selectRefs,w as selectRefsExtended,c as walkDomScope};
